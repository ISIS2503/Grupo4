[{"id":"5931635e.5e3adc","type":"tab","label":"Telemetry Flow","disabled":false,"info":""},{"id":"f3e4d5d9.50e188","type":"serial in","z":"5931635e.5e3adc","name":"Temperature Sensor","serial":"1df16924.c31ff7","x":158,"y":131.0000057220459,"wires":[["7f6bd040.ed499","ae5c1f46.b4d93"]]},{"id":"8a852a6f.948a48","type":"inject","z":"5931635e.5e3adc","name":"Sensor Time","topic":"roomTime","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":173,"y":248,"wires":[["981bbedc.38756","b9cef4c0.ea7e88"]]},{"id":"ae5c1f46.b4d93","type":"function","z":"5931635e.5e3adc","name":"Format Temperature","func":"var res = {};\nvar tempArray = [];\nvar tempUnit = \"\";\n\ntempString = msg.payload;\ntempArray = tempString.split(\"\\t\");\ntempUnit = tempArray[1].replace(\"\\r\\n\", \"\");\nres.topic = \"roomTemperature\";\nres.payload = {};\n\nres.payload = {\"data\": parseInt(tempArray[0]), \"unit\": tempUnit, \"place\": \"Deposito Externo\"}\n\nreturn res;","outputs":1,"noerr":0,"x":449,"y":144,"wires":[["cd7b6427.ce31d8","5f6cb34c.b4e02c"]]},{"id":"b9cef4c0.ea7e88","type":"function","z":"5931635e.5e3adc","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":422,"y":247,"wires":[["c56c9307.d8891","5f6cb34c.b4e02c"]]},{"id":"981bbedc.38756","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":415,"y":196,"wires":[]},{"id":"7f6bd040.ed499","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":422,"y":91,"wires":[]},{"id":"cd7b6427.ce31d8","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":693,"y":178,"wires":[]},{"id":"c56c9307.d8891","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":689,"y":280,"wires":[]},{"id":"5f6cb34c.b4e02c","type":"function","z":"5931635e.5e3adc","name":"Merge 2 Messages","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"roomTime\":\n        context.data.sensetime = msg.payload;\n        msg = null;\n        break;\n    case \"roomTemperature\":\n        context.data.temperature = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.sensetime != null && context.data.temperature != null) {\n\tres = {};\n    res.payload = JSON.stringify(context.data);\n    res.topic = \"roomTemperature\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":697,"y":231,"wires":[["bd69b62d.bab028","cac95f2e.ed20e"]]},{"id":"bd69b62d.bab028","type":"udp out","z":"5931635e.5e3adc","name":"Send Temperature","addr":"localhost","iface":"","port":"6000","ipv":"udp4","outport":"","base64":false,"multicast":"false","x":944.0000915527344,"y":190.0000228881836,"wires":[]},{"id":"cac95f2e.ed20e","type":"debug","z":"5931635e.5e3adc","name":"after Merge","active":false,"console":"false","complete":"payload","x":911,"y":280,"wires":[]},{"id":"3939445c.ca012c","type":"serial in","z":"5931635e.5e3adc","name":"Noice Sensor","serial":"1df16924.c31ff7","x":132.5078125,"y":434.5234375,"wires":[["c2b0a5f5.969b58","e9c8da3a.6b3f68"]]},{"id":"3e371557.cf57ea","type":"inject","z":"5931635e.5e3adc","name":"Sensor Time","topic":"roomTime","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":166.5078125,"y":539.5234375,"wires":[["1531502e.e4b5c","53a1be95.30bf9"]]},{"id":"e9c8da3a.6b3f68","type":"function","z":"5931635e.5e3adc","name":"Format Noice","func":"var res = {};\nvar tempArray = [];\nvar noiceUnit = \"\";\n\ntempString = msg.payload;\ntempArray = tempString.split(\"\\t\");\nnoiceUnit = tempArray[3].replace(\"\\r\\n\", \"\");\nres.topic = \"roomNoice\";\nres.payload = {};\n\nres.payload = {\"data\": parseInt(tempArray[2]), \"unit\": noiceUnit, \"place\": \"Deposito Externo\"}\n\nreturn res;","outputs":1,"noerr":0,"x":422.5078125,"y":435.5234375,"wires":[["931f6e3f.4386d","5da9a3a5.aaa12c"]]},{"id":"53a1be95.30bf9","type":"function","z":"5931635e.5e3adc","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":415.5078125,"y":538.5234375,"wires":[["d8e11bec.66fd58","5da9a3a5.aaa12c"]]},{"id":"1531502e.e4b5c","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":408.5078125,"y":487.5234375,"wires":[]},{"id":"c2b0a5f5.969b58","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":415.5078125,"y":382.5234375,"wires":[]},{"id":"931f6e3f.4386d","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":686.5078125,"y":469.5234375,"wires":[]},{"id":"d8e11bec.66fd58","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":682.5078125,"y":571.5234375,"wires":[]},{"id":"5da9a3a5.aaa12c","type":"function","z":"5931635e.5e3adc","name":"Merge 2 Messages","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"roomTime\":\n        context.data.sensetime = msg.payload;\n        msg = null;\n        break;\n    case \"roomNoice\":\n        context.data.noice = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.sensetime != null && context.data.noice != null) {\n\tres = {};\n    res.payload = JSON.stringify(context.data);\n    res.topic = \"roomNoice\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":690.5078125,"y":522.5234375,"wires":[["55893757.bc8f28","d1c86b6d.357d48"]]},{"id":"55893757.bc8f28","type":"udp out","z":"5931635e.5e3adc","name":"Send Noice","addr":"localhost","iface":"","port":"6001","ipv":"udp4","outport":"","base64":false,"multicast":"false","x":904.5078125,"y":505.5234375,"wires":[]},{"id":"d1c86b6d.357d48","type":"debug","z":"5931635e.5e3adc","name":"after Merge","active":false,"console":"false","complete":"payload","x":904.5078125,"y":571.5234375,"wires":[]},{"id":"4161b52c.4a251c","type":"serial in","z":"5931635e.5e3adc","name":"Carbon dioxide Sensor","serial":"1df16924.c31ff7","x":183.5078125,"y":754.5234375,"wires":[["7a92bc8b.a55314","47f85f1c.57f34"]]},{"id":"d56c5a2e.241ff8","type":"inject","z":"5931635e.5e3adc","name":"Sensor Time","topic":"roomTime","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":187.5078125,"y":859.5234375,"wires":[["649b5e2c.6dd4f","965e864e.3c1a98"]]},{"id":"47f85f1c.57f34","type":"function","z":"5931635e.5e3adc","name":"Format carbon dioxide","func":"var res = {};\nvar tempArray = [];\nvar tempUnit = \"\";\n\ntempString = msg.payload;\ntempArray = tempString.split(\"\\t\");\ndioxideUnit = tempArray[5].replace(\"\\r\\n\", \"\");\nres.topic = \"roomCarbonDioxide\";\nres.payload = {};\n\nres.payload = {\"data\": parseInt(tempArray[4]), \"unit\": dioxideUnit, \"place\": \"Deposito Externo\"}\n\nreturn res;","outputs":1,"noerr":0,"x":463.5078125,"y":755.5234375,"wires":[["7e432b4d.1730a4","eef05a1d.6f4a98"]]},{"id":"965e864e.3c1a98","type":"function","z":"5931635e.5e3adc","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":436.5078125,"y":858.5234375,"wires":[["99cabcd8.66a2d","eef05a1d.6f4a98"]]},{"id":"649b5e2c.6dd4f","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":429.5078125,"y":807.5234375,"wires":[]},{"id":"7a92bc8b.a55314","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":436.5078125,"y":702.5234375,"wires":[]},{"id":"7e432b4d.1730a4","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":707.5078125,"y":789.5234375,"wires":[]},{"id":"99cabcd8.66a2d","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":703.5078125,"y":891.5234375,"wires":[]},{"id":"eef05a1d.6f4a98","type":"function","z":"5931635e.5e3adc","name":"Merge 2 Messages","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"roomTime\":\n        context.data.sensetime = msg.payload;\n        msg = null;\n        break;\n    case \"roomCarbonDioxide\":\n        context.data.carbonDioxide = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.sensetime != null && context.data.carbonDioxide != null) {\n\tres = {};\n    res.payload = JSON.stringify(context.data);\n    res.topic = \"roomCarbonDioxide\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":711.5078125,"y":842.5234375,"wires":[["559f3802.e02078","d00abead.725e"]]},{"id":"559f3802.e02078","type":"udp out","z":"5931635e.5e3adc","name":"Send Carbon Dioxide","addr":"localhost","iface":"","port":"6002","ipv":"udp4","outport":"","base64":false,"multicast":"false","x":955.5078125,"y":825.5234375,"wires":[]},{"id":"d00abead.725e","type":"debug","z":"5931635e.5e3adc","name":"after Merge","active":false,"console":"false","complete":"payload","x":925.5078125,"y":891.5234375,"wires":[]},{"id":"760f31d2.0da65","type":"serial in","z":"5931635e.5e3adc","name":"Ilumination Sensor","serial":"1df16924.c31ff7","x":206.5078125,"y":1091.5234375,"wires":[["f97a1af6.3506c8","d0e281f3.d8b01"]]},{"id":"3f5fa0b8.b424f","type":"inject","z":"5931635e.5e3adc","name":"Sensor Time","topic":"roomTime","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":220.5078125,"y":1196.5234375,"wires":[["9ac2762d.bb4298","598dbd78.a9cda4"]]},{"id":"d0e281f3.d8b01","type":"function","z":"5931635e.5e3adc","name":"Format Ilumination","func":"var res = {};\nvar tempArray = [];\nvar iluminationUnit = \"\";\n\ntempString = msg.payload;\ntempArray = tempString.split(\"\\t\");\niluminationUnit = tempArray[7].replace(\"\\r\\n\", \"\");\nres.topic = \"roomIlumination\";\nres.payload = {};\n\nres.payload = {\"data\": parseInt(tempArray[6]), \"unit\": iluminationUnit, \"place\": \"Deposito Externo\"}\n\nreturn res;","outputs":1,"noerr":0,"x":486.5078125,"y":1092.5234375,"wires":[["c70e97c9.a8f338","3d0ab1d.35aed4e"]]},{"id":"598dbd78.a9cda4","type":"function","z":"5931635e.5e3adc","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":469.5078125,"y":1195.5234375,"wires":[["45d8f32f.bdfd6c","3d0ab1d.35aed4e"]]},{"id":"9ac2762d.bb4298","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":462.5078125,"y":1144.5234375,"wires":[]},{"id":"f97a1af6.3506c8","type":"debug","z":"5931635e.5e3adc","name":"before format","active":false,"console":"false","complete":"payload","x":469.5078125,"y":1039.5234375,"wires":[]},{"id":"c70e97c9.a8f338","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":740.5078125,"y":1126.5234375,"wires":[]},{"id":"45d8f32f.bdfd6c","type":"debug","z":"5931635e.5e3adc","name":"after Format","active":false,"console":"false","complete":"payload","x":736.5078125,"y":1228.5234375,"wires":[]},{"id":"3d0ab1d.35aed4e","type":"function","z":"5931635e.5e3adc","name":"Merge 2 Messages","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"roomTime\":\n        context.data.sensetime = msg.payload;\n        msg = null;\n        break;\n    case \"roomIlumination\":\n        context.data.ilumination = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.sensetime != null && context.data.ilumination != null) {\n\tres = {};\n    res.payload = JSON.stringify(context.data);\n    res.topic = \"roomIlumination\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":744.5078125,"y":1179.5234375,"wires":[["8881f49e.3268e8","a558b1b.b536b5"]]},{"id":"8881f49e.3268e8","type":"udp out","z":"5931635e.5e3adc","name":"Send Ilumination","addr":"localhost","iface":"","port":"6003","ipv":"udp4","outport":"","base64":false,"multicast":"false","x":978.5078125,"y":1162.5234375,"wires":[]},{"id":"a558b1b.b536b5","type":"debug","z":"5931635e.5e3adc","name":"after Merge","active":false,"console":"false","complete":"payload","x":958.5078125,"y":1228.5234375,"wires":[]},{"id":"1df16924.c31ff7","type":"serial-port","z":"","serialport":"COM3","serialbaud":"9600","databits":"8","parity":"none","stopbits":"1","newline":"\\n","bin":"false","out":"char","addchar":true}]