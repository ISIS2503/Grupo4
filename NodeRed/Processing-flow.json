[{"id":"e1cdaa74.e15d38","type":"tab","label":"Processing Flow","disabled":false,"info":""},{"id":"3ba4295.0f3c1d6","type":"udp in","z":"e1cdaa74.e15d38","name":"UDP incoming temperature","iface":"","port":"6000","ipv":"udp4","multicast":"false","group":"","datatype":"utf8","x":216.25003814697266,"y":162.51734733581543,"wires":[["1a25d326.41df6d","8ed4b4a5.87ead8"]]},{"id":"1a25d326.41df6d","type":"debug","z":"e1cdaa74.e15d38","name":"incoming data","active":false,"console":"false","complete":"payload","x":429.0834083557129,"y":125.11804103851318,"wires":[]},{"id":"8ed4b4a5.87ead8","type":"json","z":"e1cdaa74.e15d38","name":"Format 2 json","pretty":true,"x":431.0764617919922,"y":198.767352104187,"wires":[["1beeda69.3152a6","51ef917d.468a7"]]},{"id":"1beeda69.3152a6","type":"debug","z":"e1cdaa74.e15d38","name":"JSON format","active":false,"console":"false","complete":"payload","x":621.0648612976074,"y":198.77700757980347,"wires":[]},{"id":"51ef917d.468a7","type":"function","z":"e1cdaa74.e15d38","name":"Add Topic","func":"var res = {};\n\nres.payload = msg.payload;\nres.topic = \"roomTemperature\";\n\nreturn res;","outputs":1,"noerr":0,"x":619.9614673190647,"y":264.78393438127307,"wires":[["f6cb57b9.604148","1cb8011f.993b5f"]]},{"id":"17aa49b1.2de1e6","type":"inject","z":"e1cdaa74.e15d38","name":"Incoming Time","topic":"incomingTime","payload":"","payloadType":"date","repeat":"3600","crontab":"","once":true,"x":215.51703643798828,"y":354.4135675430298,"wires":[["1d2540b4.59487f","54280472.f878bc"]]},{"id":"1d2540b4.59487f","type":"debug","z":"e1cdaa74.e15d38","name":"before format","active":false,"console":"false","complete":"payload","x":418.8464813232422,"y":289.0200614929199,"wires":[]},{"id":"54280472.f878bc","type":"function","z":"e1cdaa74.e15d38","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":426.6242684258355,"y":355.8911968866984,"wires":[["6a9eaa4a.05cd44","f6cb57b9.604148"]]},{"id":"6a9eaa4a.05cd44","type":"debug","z":"e1cdaa74.e15d38","name":"after format","active":false,"console":"false","complete":"payload","x":615.5170288085938,"y":424.5833339691162,"wires":[]},{"id":"f6cb57b9.604148","type":"function","z":"e1cdaa74.e15d38","name":"Merge 2 Msgs","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"incomingTime\":\n        context.data.recvtime = msg.payload;\n        msg = null;\n        break;\n    case \"roomTemperature\":\n        context.data.room = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.recvtime != null && context.data.room != null) {\n\tres = {};\n    res.payload = context.data;\n    res.topic = \"roomTemperature\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":838.8427124023438,"y":356.00308895111084,"wires":[["904e3cfd.2f178","5aaa180c.894238","83680d6c.e2b06"]]},{"id":"1cb8011f.993b5f","type":"debug","z":"e1cdaa74.e15d38","name":"after topic","active":false,"console":"false","complete":"payload","x":821.0688018798828,"y":265.19675159454346,"wires":[]},{"id":"904e3cfd.2f178","type":"debug","z":"e1cdaa74.e15d38","name":"after merge","active":false,"console":"false","complete":"payload","x":1038.8465881347656,"y":355.06943798065186,"wires":[]},{"id":"5aaa180c.894238","type":"link out","z":"e1cdaa74.e15d38","name":"Temp","links":["a34ed7f6.3a8398"],"x":984.3943996429443,"y":412.0987539291382,"wires":[]},{"id":"92f4c726.4b26e8","type":"udp in","z":"e1cdaa74.e15d38","name":"UDP incoming noice","iface":"","port":"6001","ipv":"udp4","multicast":"false","group":"","datatype":"utf8","x":203.25787734985352,"y":517.5234231948853,"wires":[["ad06c313.a3f42","2eba681d.f05218"]]},{"id":"ad06c313.a3f42","type":"debug","z":"e1cdaa74.e15d38","name":"incoming data","active":false,"console":"false","complete":"payload","x":409.9176254272461,"y":519.124119758606,"wires":[]},{"id":"2eba681d.f05218","type":"json","z":"e1cdaa74.e15d38","name":"Format 2 json","pretty":true,"x":411.9106788635254,"y":592.7734308242798,"wires":[["701fcf3.9f1883","1a1df383.fb0f7c"]]},{"id":"701fcf3.9f1883","type":"debug","z":"e1cdaa74.e15d38","name":"JSON format","active":false,"console":"false","complete":"payload","x":601.8990783691406,"y":592.7830862998962,"wires":[]},{"id":"1a1df383.fb0f7c","type":"function","z":"e1cdaa74.e15d38","name":"Add Topic","func":"var res = {};\n\nres.payload = msg.payload;\nres.topic = \"roomNoice\";\n\nreturn res;","outputs":1,"noerr":0,"x":600.7956843905979,"y":658.7900131013658,"wires":[["c4857a71.40ec58","7568eb28.de5ba4"]]},{"id":"1b46a40d.0a455c","type":"inject","z":"e1cdaa74.e15d38","name":"Incoming Time","topic":"incomingTime","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":196.35125350952148,"y":748.4196462631226,"wires":[["1845d037.b451a","243da646.d96e9a"]]},{"id":"1845d037.b451a","type":"debug","z":"e1cdaa74.e15d38","name":"before format","active":false,"console":"false","complete":"payload","x":399.6806983947754,"y":683.0261402130127,"wires":[]},{"id":"243da646.d96e9a","type":"function","z":"e1cdaa74.e15d38","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":407.45848549736866,"y":749.8972756067913,"wires":[["28865237.ffbfee","c4857a71.40ec58"]]},{"id":"28865237.ffbfee","type":"debug","z":"e1cdaa74.e15d38","name":"after format","active":false,"console":"false","complete":"payload","x":596.351245880127,"y":818.589412689209,"wires":[]},{"id":"c4857a71.40ec58","type":"function","z":"e1cdaa74.e15d38","name":"Merge 2 Msgs","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"incomingTime\":\n        context.data.recvtime = msg.payload;\n        msg = null;\n        break;\n    case \"roomNoice\":\n        context.data.room = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.recvtime != null && context.data.room != null) {\n\tres = {};\n    res.payload = context.data;\n    res.topic = \"roomNoice\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":819.676929473877,"y":750.0091676712036,"wires":[["ae654648.e218e8","6955ae33.8478","89615256.ea48e"]]},{"id":"7568eb28.de5ba4","type":"debug","z":"e1cdaa74.e15d38","name":"after topic","active":false,"console":"false","complete":"payload","x":801.903018951416,"y":659.2028303146362,"wires":[]},{"id":"ae654648.e218e8","type":"debug","z":"e1cdaa74.e15d38","name":"after merge","active":false,"console":"false","complete":"payload","x":1019.6808052062988,"y":749.0755167007446,"wires":[]},{"id":"6955ae33.8478","type":"link out","z":"e1cdaa74.e15d38","name":"Noice","links":["30e2be.b78b5d42"],"x":965.2286167144775,"y":806.104832649231,"wires":[]},{"id":"805a2235.f56ba","type":"udp in","z":"e1cdaa74.e15d38","name":"UDP incoming carbon dioxide","iface":"","port":"6002","ipv":"udp4","multicast":"false","group":"","datatype":"utf8","x":173.7578125,"y":949.773416519165,"wires":[["34791549.a53bda","6917756d.79c87c"]]},{"id":"34791549.a53bda","type":"debug","z":"e1cdaa74.e15d38","name":"incoming data","active":false,"console":"false","complete":"payload","x":398.4175605773926,"y":930.3740844726562,"wires":[]},{"id":"6917756d.79c87c","type":"json","z":"e1cdaa74.e15d38","name":"Format 2 json","pretty":true,"x":400.4106140136719,"y":1004.0233955383301,"wires":[["4fb7b03a.5695c","44be0541.e5672c"]]},{"id":"4fb7b03a.5695c","type":"debug","z":"e1cdaa74.e15d38","name":"JSON format","active":false,"console":"false","complete":"payload","x":590.3990135192871,"y":1004.0330510139465,"wires":[]},{"id":"44be0541.e5672c","type":"function","z":"e1cdaa74.e15d38","name":"Add Topic","func":"var res = {};\n\nres.payload = msg.payload;\nres.topic = \"roomCarbonDioxide\";\n\nreturn res;","outputs":1,"noerr":0,"x":589.2956195407444,"y":1070.039977815416,"wires":[["e41bd085.d67c9","6b5b9bd9.01c514"]]},{"id":"1343d5.78efcc2c","type":"inject","z":"e1cdaa74.e15d38","name":"Incoming Time","topic":"incomingTime","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":184.85118865966797,"y":1159.6696109771729,"wires":[["f890bf8b.c7a76","55fc114a.0399b"]]},{"id":"f890bf8b.c7a76","type":"debug","z":"e1cdaa74.e15d38","name":"before format","active":false,"console":"false","complete":"payload","x":388.1806335449219,"y":1094.276104927063,"wires":[]},{"id":"55fc114a.0399b","type":"function","z":"e1cdaa74.e15d38","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":395.95842064751514,"y":1161.1472403208415,"wires":[["7e0c9c42.b08c04","e41bd085.d67c9"]]},{"id":"7e0c9c42.b08c04","type":"debug","z":"e1cdaa74.e15d38","name":"after format","active":false,"console":"false","complete":"payload","x":584.8511810302734,"y":1229.8393774032593,"wires":[]},{"id":"e41bd085.d67c9","type":"function","z":"e1cdaa74.e15d38","name":"Merge 2 Msgs","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"incomingTime\":\n        context.data.recvtime = msg.payload;\n        msg = null;\n        break;\n    case \"roomCarbonDioxide\":\n        context.data.room = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.recvtime != null && context.data.room != null) {\n\tres = {};\n    res.payload = context.data;\n    res.topic = \"roomCarbonDioxide\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":808.1768646240234,"y":1161.259132385254,"wires":[["89365916.69c3d8","128aca59.22c2e6","f3a5392e.6a6878"]]},{"id":"6b5b9bd9.01c514","type":"debug","z":"e1cdaa74.e15d38","name":"after topic","active":false,"console":"false","complete":"payload","x":790.4029541015625,"y":1070.4527950286865,"wires":[]},{"id":"89365916.69c3d8","type":"debug","z":"e1cdaa74.e15d38","name":"after merge","active":false,"console":"false","complete":"payload","x":1008.1807403564453,"y":1160.325481414795,"wires":[]},{"id":"128aca59.22c2e6","type":"link out","z":"e1cdaa74.e15d38","name":"CD","links":["7fe3a80f.718738"],"x":953.728551864624,"y":1217.3547973632812,"wires":[]},{"id":"3deba4e2.22ba1c","type":"udp in","z":"e1cdaa74.e15d38","name":"UDP incoming ilumination","iface":"","port":"6003","ipv":"udp4","multicast":"false","group":"","datatype":"utf8","x":161.5078125,"y":1348.5232973098755,"wires":[["5d661362.98307c","7aa50cae.92b274"]]},{"id":"5d661362.98307c","type":"debug","z":"e1cdaa74.e15d38","name":"incoming data","active":false,"console":"false","complete":"payload","x":419.1675605773926,"y":1338.1240119934082,"wires":[]},{"id":"7aa50cae.92b274","type":"json","z":"e1cdaa74.e15d38","name":"Format 2 json","pretty":true,"x":421.1606140136719,"y":1411.773323059082,"wires":[["a955d312.c4c7d","79745893.8620a8"]]},{"id":"a955d312.c4c7d","type":"debug","z":"e1cdaa74.e15d38","name":"JSON format","active":false,"console":"false","complete":"payload","x":611.1490135192871,"y":1411.7829785346985,"wires":[]},{"id":"79745893.8620a8","type":"function","z":"e1cdaa74.e15d38","name":"Add Topic","func":"var res = {};\n\nres.payload = msg.payload;\nres.topic = \"roomIlumination\";\n\nreturn res;","outputs":1,"noerr":0,"x":610.0456195407444,"y":1477.789905336168,"wires":[["47726694.1647d8","c9c4d99.6d6bb28"]]},{"id":"e6dc0a2f.5387b8","type":"inject","z":"e1cdaa74.e15d38","name":"Incoming Time","topic":"incomingTime","payload":"","payloadType":"date","repeat":"1","crontab":"","once":true,"x":205.60118865966797,"y":1567.4195384979248,"wires":[["fec81d57.d67f7","52734986.c01ae8"]]},{"id":"fec81d57.d67f7","type":"debug","z":"e1cdaa74.e15d38","name":"before format","active":false,"console":"false","complete":"payload","x":408.9306335449219,"y":1502.026032447815,"wires":[]},{"id":"52734986.c01ae8","type":"function","z":"e1cdaa74.e15d38","name":"Format Time","func":"var res = {};\n\nres.payload = new Date(msg.payload);\nres.topic = msg.topic;\n\nreturn res;","outputs":1,"noerr":0,"x":416.70842064751514,"y":1568.8971678415935,"wires":[["ed3ca107.52832","47726694.1647d8"]]},{"id":"ed3ca107.52832","type":"debug","z":"e1cdaa74.e15d38","name":"after format","active":false,"console":"false","complete":"payload","x":605.6011810302734,"y":1637.5893049240112,"wires":[]},{"id":"47726694.1647d8","type":"function","z":"e1cdaa74.e15d38","name":"Merge 2 Msgs","func":"context.data = context.data || {};\n\nswitch (msg.topic) {\n    case \"incomingTime\":\n        context.data.recvtime = msg.payload;\n        msg = null;\n        break;\n    case \"roomIlumination\":\n        context.data.room = msg.payload;\n        msg = null;\n        break;\n        \n    default:\n        msg = null;\n    \tbreak;\n}\n\nif(context.data.recvtime != null && context.data.room != null) {\n\tres = {};\n    res.payload = context.data;\n    res.topic = \"roomIlumination\"\n    context.data = null;\n\treturn res;\n}","outputs":1,"noerr":0,"x":828.9268646240234,"y":1569.0090599060059,"wires":[["99e78a54.233368","ac41f413.f3c428","f2b59355.758bb"]]},{"id":"c9c4d99.6d6bb28","type":"debug","z":"e1cdaa74.e15d38","name":"after topic","active":false,"console":"false","complete":"payload","x":811.1529541015625,"y":1478.2027225494385,"wires":[]},{"id":"99e78a54.233368","type":"debug","z":"e1cdaa74.e15d38","name":"after merge","active":false,"console":"false","complete":"payload","x":1047.9308433532715,"y":1580.0755290985107,"wires":[]},{"id":"ac41f413.f3c428","type":"link out","z":"e1cdaa74.e15d38","name":"Ilumination","links":["1b238993.1c8be6"],"x":974.478551864624,"y":1625.1047248840332,"wires":[]},{"id":"4003319.29871d","type":"http request","z":"e1cdaa74.e15d38","name":"","method":"POST","ret":"txt","url":"","tls":"","x":1350,"y":280,"wires":[["b600ad5d.f4b0e"]]},{"id":"83680d6c.e2b06","type":"function","z":"e1cdaa74.e15d38","name":"Realizar petición http temp","func":"var datos = [];\n\ninfoData = msg.payload;\n//datos = infoData.split(\",\");\n\nmsg.url = \"http://172.24.42.43/data\";\nmsg.headers = {};\nmsg.headers['Content-Type'] = \"application/json; charset=utf-8\"\nmsg.payload = {};\n//msg.body.valorMedida = datos[0];\nmsg.payload.valorMedida = infoData.room.temperature.valorMedida;\nmsg.payload.idSensor = infoData.room.temperature.idSensor;\n//msg.body.idSensor =  datos[2];\n\nreturn msg;","outputs":1,"noerr":0,"x":1100,"y":280,"wires":[["4003319.29871d","ef5f054b.71b968"]]},{"id":"b600ad5d.f4b0e","type":"debug","z":"e1cdaa74.e15d38","name":"","active":false,"console":"false","complete":"true","x":1510,"y":280,"wires":[]},{"id":"ef5f054b.71b968","type":"debug","z":"e1cdaa74.e15d38","name":"http request temp","active":false,"console":"false","complete":"true","x":1370,"y":360,"wires":[]},{"id":"89615256.ea48e","type":"function","z":"e1cdaa74.e15d38","name":"Realizar petición http noice","func":"var datos = [];\n\ninfoData = msg.payload;\n//datos = infoData.split(\",\");\n\nmsg.url = \"http://172.24.42.43/data\";\nmsg.headers = {};\nmsg.headers['Content-Type'] = \"application/json; charset=utf-8\"\nmsg.payload = {};\n//msg.body.valorMedida = datos[0];\nmsg.payload.valorMedida = infoData.room.noice.valorMedida;\nmsg.payload.idSensor = infoData.room.noice.idSensor;\n//msg.body.idSensor =  datos[2];\n\nreturn msg;","outputs":1,"noerr":0,"x":1080,"y":680,"wires":[["f9ab7173.c675a","5fae7fde.6cdd7"]]},{"id":"f9ab7173.c675a","type":"http request","z":"e1cdaa74.e15d38","name":"","method":"POST","ret":"txt","url":"","tls":"","x":1330,"y":680,"wires":[["989c6018.92b8a"]]},{"id":"5fae7fde.6cdd7","type":"debug","z":"e1cdaa74.e15d38","name":"http request temp","active":false,"console":"false","complete":"true","x":1350,"y":800,"wires":[]},{"id":"989c6018.92b8a","type":"debug","z":"e1cdaa74.e15d38","name":"","active":false,"console":"false","complete":"payload","x":1570,"y":680,"wires":[]},{"id":"f3a5392e.6a6878","type":"function","z":"e1cdaa74.e15d38","name":"Realizar petición http carbon","func":"var datos = [];\n\ninfoData = msg.payload;\n//datos = infoData.split(\",\");\n\nmsg.url = \"http://172.24.42.43/data\";\nmsg.headers = {};\nmsg.headers['Content-Type'] = \"application/json; charset=utf-8\"\nmsg.payload = {};\n//msg.body.valorMedida = datos[0];\nmsg.payload.valorMedida = infoData.room.carbonDioxide.valorMedida;\nmsg.payload.idSensor = infoData.room.carbonDioxide.idSensor;\n//msg.body.idSensor =  datos[2];\n\nreturn msg;","outputs":1,"noerr":0,"x":1080,"y":1100,"wires":[["f9472545.40ee38","6c0e1acd.5e5d74"]]},{"id":"f9472545.40ee38","type":"http request","z":"e1cdaa74.e15d38","name":"","method":"POST","ret":"txt","url":"","tls":"","x":1330,"y":1100,"wires":[["533d0dc1.1f5194"]]},{"id":"6c0e1acd.5e5d74","type":"debug","z":"e1cdaa74.e15d38","name":"http request temp","active":false,"console":"false","complete":"payload","x":1350,"y":1160,"wires":[]},{"id":"533d0dc1.1f5194","type":"debug","z":"e1cdaa74.e15d38","name":"","active":false,"console":"false","complete":"payload","x":1510,"y":1100,"wires":[]},{"id":"f2b59355.758bb","type":"function","z":"e1cdaa74.e15d38","name":"Realizar petición http ilum","func":"var datos = [];\n\ninfoData = msg.payload;\n//datos = infoData.split(\",\");\n\nmsg.url = \"http://172.24.42.43/data\";\nmsg.headers = {};\nmsg.headers['Content-Type'] = \"application/json; charset=utf-8\"\nmsg.payload = {};\n//msg.body.valorMedida = datos[0];\nmsg.payload.valorMedida = infoData.room.ilumination.valorMedida;\nmsg.payload.idSensor = infoData.room.ilumination.idSensor;\n//msg.body.idSensor =  datos[2];\n\nreturn msg;","outputs":1,"noerr":0,"x":1090,"y":1520,"wires":[["7601dcc.ab19124","57d87195.e335"]]},{"id":"7601dcc.ab19124","type":"http request","z":"e1cdaa74.e15d38","name":"","method":"POST","ret":"txt","url":"","tls":"","x":1350,"y":1520,"wires":[["2da7d049.0146e"]]},{"id":"57d87195.e335","type":"debug","z":"e1cdaa74.e15d38","name":"http request temp","active":true,"console":"false","complete":"true","x":1370,"y":1580,"wires":[]},{"id":"2da7d049.0146e","type":"debug","z":"e1cdaa74.e15d38","name":"repuesta temp","active":true,"console":"false","complete":"true","x":1540,"y":1520,"wires":[]}]